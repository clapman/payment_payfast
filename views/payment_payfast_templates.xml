<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="payfast_redirect_form">
        <!-- 
            FIX: Use 'api_url'. 
            Since we fixed the Python method name, this will now contain the PayFast URL.
        -->
        <form t-att-action="api_url" method="post" target="_self" id="payfast_checkout_form">
            
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            
            <t t-foreach="payfast_fields" t-as="key">
                <input type="hidden" t-att-name="key" t-att-value="payfast_fields[key]"/>
            </t>
        </form>
        
        <!-- <script type="text/javascript">
            (function() {
                var form = document.getElementById('payfast_checkout_form');
                if (form) {
                    form.submit();
                }
            })();
        </script> -->
    </template>
</odoo>